import pandas as pd
from PIL import Image
import json
from sklearn.model_selection import train_test_split

data = pd.read_csv("NLICorpusData.csv")

extra = "Output only the keypoint location of the block corresponding to following instruction. Instructions are from the perspective of the black figure. Instruction:"


data['Instruction'] = extra + data['Instruction']


correct_answers = {
    "Configuration_1_v1.png": {"x": 290.8302, "y": 554.1509},
    "Configuration_1_v2.png": {"x": 311.066, "y": 439.7406},
    "Configuration_2_v1.png": {"x": 462.0566, "y": 469.316},
    "Configuration_2_v2.png": {"x": 440.2642, "y": 484.8821},
    "Configuration_3_v1.png": {"x": 355.4292, "y": 424.9528},
    "Configuration_3_v2.png": {"x": 466.7264, "y": 500.4481},
    "Configuration_4_v1.png": {"x": 324.2972, "y": 499.6698},
    "Configuration_4_v2.png": {"x": 330.5236, "y": 470.8726},
    "Configuration_5_v1.png": {"x": 433.2153, "y": 530.9007},
    "Configuration_5_v2.png": {"x": 402.2421, "y": 551.5495},
    "Configuration_6_v1.png": {"x": 458.9434, "y": 484.8821},
    "Configuration_6_v2.png": {"x": 378.7783, "y": 495.7783},
    "Configuration_7_v1.png": {"x": 487.7406, "y": 488.7736},
    "Configuration_7_v2.png": {"x": 508.7547,"y": 511.3443},
    "Configuration_8_v1.png": {"x": 353.0943, "y": 497.3349},
    "Configuration_8_v2.png": {"x": 386.5613, "y": 498.8915},
    "Configuration_9_v1.png": {"x": 427.033, "y": 534.6934},
    "Configuration_9_v2.png": {"x": 345.3113, "y": 424.9528},
    "Configuration_10_v1.png": {"x": 494.7453, "y": 534.6934},
    "Configuration_10_v2.png": {"x": 342.1981, "y": 437.4057},
    "Configuration_11_v1.png": {"x": 463.6132, "y": 487.9953},
    "Configuration_11_v2.png": {"x": 319.6274, "y": 463.8679},
    "Configuration_12_v1.png": {"x": 366.3255, "y": 546.3679},
    "Configuration_12_v2.png": {"x": 329.7453, "y": 557.2642},
    "Configuration_13_v1.png": {"x": 332.0802, "y": 517.5708},
    "Configuration_13_v2.png": {"x": 413.8019, "y": 491.1085},
    "Configuration_14_v1.png": {"x": 309.5094, "y": 477.8774},
    "Configuration_14_v2.png": {"x": 378.7783, "y": 457.6415},
}

lab = {
    "Configuration_1_v1.png": [{'name': 'yellow', 'keypoint': {'x': 291, 'y': 544}}, {'name': 'orange', 'keypoint': {'x': 352, 'y': 547}}, {'name': 'green', 'keypoint': {'x': 324, 'y': 532}}, {'name': 'orange', 'keypoint': {'x': 317, 'y': 503}}, {'name': 'green', 'keypoint': {'x': 385, 'y': 547}}, {'name': 'orange', 'keypoint': {'x': 370, 'y': 499}}, {'name': 'green', 'keypoint': {'x': 357, 'y': 470}}, {'name': 'green', 'keypoint': {'x': 313, 'y': 447}}, {'name': 'blue', 'keypoint': {'x': 407, 'y': 504}}, {'name': 'orange', 'keypoint': {'x': 443, 'y': 533}}, {'name': 'blue', 'keypoint': {'x': 452, 'y': 502}}, {'name': 'green', 'keypoint': {'x': 458, 'y': 484}}, {'name': 'orange', 'keypoint': {'x': 464, 'y': 462}}, {'name': 'green', 'keypoint': {'x': 506, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 414, 'y': 454}}],
    "Configuration_1_v2.png": [{'name': 'yellow', 'keypoint': {'x': 291, 'y': 544}}, {'name': 'orange', 'keypoint': {'x': 352, 'y': 547}}, {'name': 'green', 'keypoint': {'x': 324, 'y': 532}}, {'name': 'orange', 'keypoint': {'x': 317, 'y': 503}}, {'name': 'green', 'keypoint': {'x': 385, 'y': 547}}, {'name': 'orange', 'keypoint': {'x': 370, 'y': 499}}, {'name': 'green', 'keypoint': {'x': 357, 'y': 470}}, {'name': 'green', 'keypoint': {'x': 313, 'y': 447}}, {'name': 'blue', 'keypoint': {'x': 407, 'y': 504}}, {'name': 'orange', 'keypoint': {'x': 443, 'y': 533}}, {'name': 'blue', 'keypoint': {'x': 452, 'y': 502}}, {'name': 'green', 'keypoint': {'x': 458, 'y': 484}}, {'name': 'orange', 'keypoint': {'x': 464, 'y': 462}}, {'name': 'green', 'keypoint': {'x': 506, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 414, 'y': 454}}],
    "Configuration_2_v1.png": [{'name': 'blue', 'keypoint': {'x': 296, 'y': 552}}, {'name': 'yellow', 'keypoint': {'x': 331, 'y': 551}}, {'name': 'green', 'keypoint': {'x': 336, 'y': 512}}, {'name': 'orange', 'keypoint': {'x': 323, 'y': 485}}, {'name': 'blue', 'keypoint': {'x': 310, 'y': 454}}, {'name': 'yellow', 'keypoint': {'x': 352, 'y': 469}}, {'name': 'blue', 'keypoint': {'x': 395, 'y': 518}}, {'name': 'yellow', 'keypoint': {'x': 420, 'y': 548}}, {'name': 'orange', 'keypoint': {'x': 428, 'y': 444}}, {'name': 'blue', 'keypoint': {'x': 430, 'y': 486}}, {'name': 'blue', 'keypoint': {'x': 459, 'y': 457}}, {'name': 'blue', 'keypoint': {'x': 496, 'y': 459}}, {'name': 'yellow', 'keypoint': {'x': 481, 'y': 480}}, {'name': 'green', 'keypoint': {'x': 484, 'y': 500}}, {'name': 'green', 'keypoint': {'x': 498, 'y': 546}}],
    "Configuration_2_v2.png": [{'name': 'blue', 'keypoint': {'x': 296, 'y': 552}}, {'name': 'yellow', 'keypoint': {'x': 331, 'y': 551}}, {'name': 'green', 'keypoint': {'x': 336, 'y': 512}}, {'name': 'orange', 'keypoint': {'x': 323, 'y': 485}}, {'name': 'blue', 'keypoint': {'x': 310, 'y': 454}}, {'name': 'yellow', 'keypoint': {'x': 352, 'y': 469}}, {'name': 'blue', 'keypoint': {'x': 395, 'y': 518}}, {'name': 'yellow', 'keypoint': {'x': 420, 'y': 548}}, {'name': 'orange', 'keypoint': {'x': 428, 'y': 444}}, {'name': 'blue', 'keypoint': {'x': 430, 'y': 486}}, {'name': 'blue', 'keypoint': {'x': 459, 'y': 457}}, {'name': 'blue', 'keypoint': {'x': 496, 'y': 459}}, {'name': 'yellow', 'keypoint': {'x': 481, 'y': 480}}, {'name': 'green', 'keypoint': {'x': 484, 'y': 500}}, {'name': 'green', 'keypoint': {'x': 498, 'y': 546}}],
    "Configuration_3_v1.png": [{'name': 'yellow', 'keypoint': {'x': 312, 'y': 538}}, {'name': 'blue', 'keypoint': {'x': 346, 'y': 510}}, {'name': 'blue', 'keypoint': {'x': 356, 'y': 485}}, {'name': 'orange', 'keypoint': {'x': 315, 'y': 481}}, {'name': 'yellow', 'keypoint': {'x': 340, 'y': 442}}, {'name': 'green', 'keypoint': {'x': 353, 'y': 421}}, {'name': 'blue', 'keypoint': {'x': 395, 'y': 437}}, {'name': 'orange', 'keypoint': {'x': 406, 'y': 458}}, {'name': 'yellow', 'keypoint': {'x': 392, 'y': 499}}, {'name': 'yellow', 'keypoint': {'x': 446, 'y': 426}}, {'name': 'orange', 'keypoint': {'x': 468, 'y': 459}}, {'name': 'green', 'keypoint': {'x': 469, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 500, 'y': 463}}, {'name': 'blue', 'keypoint': {'x': 449, 'y': 538}}, {'name': 'blue', 'keypoint': {'x': 501, 'y': 528}}],
    "Configuration_3_v2.png": [{'name': 'yellow', 'keypoint': {'x': 312, 'y': 538}}, {'name': 'blue', 'keypoint': {'x': 346, 'y': 510}}, {'name': 'blue', 'keypoint': {'x': 356, 'y': 485}}, {'name': 'orange', 'keypoint': {'x': 315, 'y': 481}}, {'name': 'yellow', 'keypoint': {'x': 340, 'y': 442}}, {'name': 'green', 'keypoint': {'x': 353, 'y': 421}}, {'name': 'blue', 'keypoint': {'x': 395, 'y': 437}}, {'name': 'orange', 'keypoint': {'x': 406, 'y': 458}}, {'name': 'yellow', 'keypoint': {'x': 392, 'y': 499}}, {'name': 'yellow', 'keypoint': {'x': 446, 'y': 426}}, {'name': 'orange', 'keypoint': {'x': 468, 'y': 459}}, {'name': 'green', 'keypoint': {'x': 469, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 500, 'y': 463}}, {'name': 'blue', 'keypoint': {'x': 449, 'y': 538}}, {'name': 'blue', 'keypoint': {'x': 501, 'y': 528}}],
    "Configuration_4_v1.png": [{'name': 'yellow', 'keypoint': {'x': 304, 'y': 547}}, {'name': 'blue', 'keypoint': {'x': 292, 'y': 498}}, {'name': 'yellow', 'keypoint': {'x': 309, 'y': 451}}, {'name': 'orange', 'keypoint': {'x': 305, 'y': 430}}, {'name': 'yellow', 'keypoint': {'x': 330, 'y': 464}}, {'name': 'yellow', 'keypoint': {'x': 321, 'y': 508}}, {'name': 'yellow', 'keypoint': {'x': 346, 'y': 515}}, {'name': 'yellow', 'keypoint': {'x': 379, 'y': 470}}, {'name': 'blue', 'keypoint': {'x': 384, 'y': 507}}, {'name': 'yellow', 'keypoint': {'x': 402, 'y': 447}}, {'name': 'blue', 'keypoint': {'x': 453, 'y': 425}}, {'name': 'orange', 'keypoint': {'x': 469, 'y': 449}}, {'name': 'yellow', 'keypoint': {'x': 464, 'y': 490}}, {'name': 'green', 'keypoint': {'x': 493, 'y': 472}}, {'name': 'yellow', 'keypoint': {'x': 499, 'y': 519}}],
    "Configuration_4_v2.png": [{'name': 'yellow', 'keypoint': {'x': 304, 'y': 547}}, {'name': 'blue', 'keypoint': {'x': 292, 'y': 498}}, {'name': 'yellow', 'keypoint': {'x': 309, 'y': 451}}, {'name': 'orange', 'keypoint': {'x': 305, 'y': 430}}, {'name': 'yellow', 'keypoint': {'x': 330, 'y': 464}}, {'name': 'yellow', 'keypoint': {'x': 321, 'y': 508}}, {'name': 'yellow', 'keypoint': {'x': 346, 'y': 515}}, {'name': 'yellow', 'keypoint': {'x': 379, 'y': 470}}, {'name': 'blue', 'keypoint': {'x': 384, 'y': 507}}, {'name': 'yellow', 'keypoint': {'x': 402, 'y': 447}}, {'name': 'blue', 'keypoint': {'x': 453, 'y': 425}}, {'name': 'orange', 'keypoint': {'x': 469, 'y': 449}}, {'name': 'yellow', 'keypoint': {'x': 464, 'y': 490}}, {'name': 'green', 'keypoint': {'x': 493, 'y': 472}}, {'name': 'yellow', 'keypoint': {'x': 499, 'y': 519}}],
    "Configuration_5_v1.png": [{'name': 'green', 'keypoint': {'x': 313, 'y': 546}}, {'name': 'yellow', 'keypoint': {'x': 315, 'y': 501}}, {'name': 'blue', 'keypoint': {'x': 302, 'y': 466}}, {'name': 'green', 'keypoint': {'x': 339, 'y': 446}}, {'name': 'orange', 'keypoint': {'x': 358, 'y': 519}}, {'name': 'orange', 'keypoint': {'x': 364, 'y': 460}}, {'name': 'orange', 'keypoint': {'x': 430, 'y': 506}}, {'name': 'yellow', 'keypoint': {'x': 372, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 396, 'y': 516}}, {'name': 'yellow', 'keypoint': {'x': 407, 'y': 551}}, {'name': 'orange', 'keypoint': {'x': 434, 'y': 539}}, {'name': 'blue', 'keypoint': {'x': 420, 'y': 483}}, {'name': 'blue', 'keypoint': {'x': 448, 'y': 444}}, {'name': 'yellow', 'keypoint': {'x': 464, 'y': 502}}, {'name': 'green', 'keypoint': {'x': 501, 'y': 465}}],
    "Configuration_5_v2.png": [{'name': 'green', 'keypoint': {'x': 313, 'y': 546}}, {'name': 'yellow', 'keypoint': {'x': 315, 'y': 501}}, {'name': 'blue', 'keypoint': {'x': 302, 'y': 466}}, {'name': 'green', 'keypoint': {'x': 339, 'y': 446}}, {'name': 'orange', 'keypoint': {'x': 358, 'y': 519}}, {'name': 'orange', 'keypoint': {'x': 364, 'y': 460}}, {'name': 'orange', 'keypoint': {'x': 430, 'y': 506}}, {'name': 'yellow', 'keypoint': {'x': 372, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 396, 'y': 516}}, {'name': 'yellow', 'keypoint': {'x': 407, 'y': 551}}, {'name': 'orange', 'keypoint': {'x': 434, 'y': 539}}, {'name': 'blue', 'keypoint': {'x': 420, 'y': 483}}, {'name': 'blue', 'keypoint': {'x': 448, 'y': 444}}, {'name': 'yellow', 'keypoint': {'x': 464, 'y': 502}}, {'name': 'green', 'keypoint': {'x': 501, 'y': 465}}],
    "Configuration_6_v1.png": [{'name': 'yellow', 'keypoint': {'x': 288, 'y': 540}}, {'name': 'orange', 'keypoint': {'x': 309, 'y': 518}}, {'name': 'green', 'keypoint': {'x': 336, 'y': 517}}, {'name': 'blue', 'keypoint': {'x': 317, 'y': 481}}, {'name': 'orange', 'keypoint': {'x': 315, 'y': 445}}, {'name': 'yellow', 'keypoint': {'x': 369, 'y': 427}}, {'name': 'yellow', 'keypoint': {'x': 397, 'y': 466}}, {'name': 'green', 'keypoint': {'x': 381, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 380, 'y': 512}}, {'name': 'orange', 'keypoint': {'x': 381, 'y': 554}}, {'name': 'green', 'keypoint': {'x': 434, 'y': 454}}, {'name': 'green', 'keypoint': {'x': 462, 'y': 486}}, {'name': 'green', 'keypoint': {'x': 461, 'y': 446}}, {'name': 'green', 'keypoint': {'x': 443, 'y': 513}}, {'name': 'green', 'keypoint': {'x': 489, 'y': 518}}],
    "Configuration_6_v2.png": [{'name': 'yellow', 'keypoint': {'x': 288, 'y': 540}}, {'name': 'orange', 'keypoint': {'x': 309, 'y': 518}}, {'name': 'green', 'keypoint': {'x': 336, 'y': 517}}, {'name': 'blue', 'keypoint': {'x': 317, 'y': 481}}, {'name': 'orange', 'keypoint': {'x': 315, 'y': 445}}, {'name': 'yellow', 'keypoint': {'x': 369, 'y': 427}}, {'name': 'yellow', 'keypoint': {'x': 397, 'y': 466}}, {'name': 'green', 'keypoint': {'x': 381, 'y': 492}}, {'name': 'orange', 'keypoint': {'x': 380, 'y': 512}}, {'name': 'orange', 'keypoint': {'x': 381, 'y': 554}}, {'name': 'green', 'keypoint': {'x': 434, 'y': 454}}, {'name': 'green', 'keypoint': {'x': 462, 'y': 486}}, {'name': 'green', 'keypoint': {'x': 461, 'y': 446}}, {'name': 'green', 'keypoint': {'x': 443, 'y': 513}}, {'name': 'green', 'keypoint': {'x': 489, 'y': 518}}],
    "Configuration_7_v1.png": [{'name': 'orange', 'keypoint': {'x': 322, 'y': 558}}, {'name': 'blue', 'keypoint': {'x': 352, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 289, 'y': 494}}, {'name': 'green', 'keypoint': {'x': 328, 'y': 463}}, {'name': 'orange', 'keypoint': {'x': 337, 'y': 509}}, {'name': 'orange', 'keypoint': {'x': 292, 'y': 450}}, {'name': 'yellow', 'keypoint': {'x': 382, 'y': 453}}, {'name': 'orange', 'keypoint': {'x': 377, 'y': 477}}, {'name': 'orange', 'keypoint': {'x': 389, 'y': 494}}, {'name': 'yellow', 'keypoint': {'x': 386, 'y': 527}}, {'name': 'orange', 'keypoint': {'x': 439, 'y': 509}}, {'name': 'yellow', 'keypoint': {'x': 484, 'y': 442}}, {'name': 'blue', 'keypoint': {'x': 480, 'y': 479}}, {'name': 'green', 'keypoint': {'x': 515, 'y': 510}}, {'name': 'green', 'keypoint': {'x': 498, 'y': 561}}],
    "Configuration_7_v2.png": [{'name': 'orange', 'keypoint': {'x': 322, 'y': 558}}, {'name': 'blue', 'keypoint': {'x': 352, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 289, 'y': 494}}, {'name': 'green', 'keypoint': {'x': 328, 'y': 463}}, {'name': 'orange', 'keypoint': {'x': 337, 'y': 509}}, {'name': 'orange', 'keypoint': {'x': 292, 'y': 450}}, {'name': 'yellow', 'keypoint': {'x': 382, 'y': 453}}, {'name': 'orange', 'keypoint': {'x': 377, 'y': 477}}, {'name': 'orange', 'keypoint': {'x': 389, 'y': 494}}, {'name': 'yellow', 'keypoint': {'x': 386, 'y': 527}}, {'name': 'orange', 'keypoint': {'x': 439, 'y': 509}}, {'name': 'yellow', 'keypoint': {'x': 484, 'y': 442}}, {'name': 'blue', 'keypoint': {'x': 480, 'y': 479}}, {'name': 'green', 'keypoint': {'x': 515, 'y': 510}}, {'name': 'green', 'keypoint': {'x': 498, 'y': 561}}],
    "Configuration_8_v1.png": [{'name': 'green', 'keypoint': {'x': 321, 'y': 550}}, {'name': 'blue', 'keypoint': {'x': 321, 'y': 515}}, {'name': 'blue', 'keypoint': {'x': 294, 'y': 506}}, {'name': 'green', 'keypoint': {'x': 331, 'y': 491}}, {'name': 'blue', 'keypoint': {'x': 326, 'y': 445}}, {'name': 'green', 'keypoint': {'x': 354, 'y': 499}}, {'name': 'green', 'keypoint': {'x': 387, 'y': 500}}, {'name': 'yellow', 'keypoint': {'x': 375, 'y': 532}}, {'name': 'green', 'keypoint': {'x': 409, 'y': 435}}, {'name': 'green', 'keypoint': {'x': 440, 'y': 442}}, {'name': 'blue', 'keypoint': {'x': 432, 'y': 484}}, {'name': 'yellow', 'keypoint': {'x': 471, 'y': 443}}, {'name': 'green', 'keypoint': {'x': 473, 'y': 481}}, {'name': 'orange', 'keypoint': {'x': 473, 'y': 536}}, {'name': 'green', 'keypoint': {'x': 368, 'y': 439}}],
    "Configuration_8_v2.png": [{'name': 'green', 'keypoint': {'x': 321, 'y': 550}}, {'name': 'blue', 'keypoint': {'x': 321, 'y': 515}}, {'name': 'blue', 'keypoint': {'x': 294, 'y': 506}}, {'name': 'green', 'keypoint': {'x': 331, 'y': 491}}, {'name': 'blue', 'keypoint': {'x': 326, 'y': 445}}, {'name': 'green', 'keypoint': {'x': 354, 'y': 499}}, {'name': 'green', 'keypoint': {'x': 387, 'y': 500}}, {'name': 'yellow', 'keypoint': {'x': 375, 'y': 532}}, {'name': 'green', 'keypoint': {'x': 409, 'y': 435}}, {'name': 'green', 'keypoint': {'x': 440, 'y': 442}}, {'name': 'blue', 'keypoint': {'x': 432, 'y': 484}}, {'name': 'yellow', 'keypoint': {'x': 471, 'y': 443}}, {'name': 'green', 'keypoint': {'x': 473, 'y': 481}}, {'name': 'orange', 'keypoint': {'x': 473, 'y': 536}}, {'name': 'green', 'keypoint': {'x': 368, 'y': 439}}],
    "Configuration_9_v1.png": [{'name': 'orange', 'keypoint': {'x': 317, 'y': 546}}, {'name': 'yellow', 'keypoint': {'x': 293, 'y': 534}}, {'name': 'green', 'keypoint': {'x': 304, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 338, 'y': 524}}, {'name': 'green', 'keypoint': {'x': 297, 'y': 462}}, {'name': 'green', 'keypoint': {'x': 343, 'y': 417}}, {'name': 'yellow', 'keypoint': {'x': 379, 'y': 452}}, {'name': 'blue', 'keypoint': {'x': 384, 'y': 500}}, {'name': 'yellow', 'keypoint': {'x': 370, 'y': 542}}, {'name': 'blue', 'keypoint': {'x': 423, 'y': 481}}, {'name': 'green', 'keypoint': {'x': 428, 'y': 541}}, {'name': 'orange', 'keypoint': {'x': 450, 'y': 452}}, {'name': 'yellow', 'keypoint': {'x': 480, 'y': 437}}, {'name': 'yellow', 'keypoint': {'x': 482, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 496, 'y': 534}}],
    "Configuration_9_v2.png": [{'name': 'orange', 'keypoint': {'x': 317, 'y': 546}}, {'name': 'yellow', 'keypoint': {'x': 293, 'y': 534}}, {'name': 'green', 'keypoint': {'x': 304, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 338, 'y': 524}}, {'name': 'green', 'keypoint': {'x': 297, 'y': 462}}, {'name': 'green', 'keypoint': {'x': 343, 'y': 417}}, {'name': 'yellow', 'keypoint': {'x': 379, 'y': 452}}, {'name': 'blue', 'keypoint': {'x': 384, 'y': 500}}, {'name': 'yellow', 'keypoint': {'x': 370, 'y': 542}}, {'name': 'blue', 'keypoint': {'x': 423, 'y': 481}}, {'name': 'green', 'keypoint': {'x': 428, 'y': 541}}, {'name': 'orange', 'keypoint': {'x': 450, 'y': 452}}, {'name': 'yellow', 'keypoint': {'x': 480, 'y': 437}}, {'name': 'yellow', 'keypoint': {'x': 482, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 496, 'y': 534}}],
    "Configuration_10_v1.png": [{'name': 'green', 'keypoint': {'x': 319, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 313, 'y': 493}}, {'name': 'blue', 'keypoint': {'x': 314, 'y': 475}}, {'name': 'blue', 'keypoint': {'x': 315, 'y': 445}}, {'name': 'green', 'keypoint': {'x': 342, 'y': 486}}, {'name': 'orange', 'keypoint': {'x': 339, 'y': 433}}, {'name': 'yellow', 'keypoint': {'x': 352, 'y': 521}}, {'name': 'blue', 'keypoint': {'x': 372, 'y': 480}}, {'name': 'yellow', 'keypoint': {'x': 376, 'y': 427}}, {'name': 'blue', 'keypoint': {'x': 413, 'y': 431}}, {'name': 'blue', 'keypoint': {'x': 405, 'y': 457}}, {'name': 'green', 'keypoint': {'x': 416, 'y': 496}}, {'name': 'yellow', 'keypoint': {'x': 408, 'y': 532}}, {'name': 'orange', 'keypoint': {'x': 461, 'y': 470}}, {'name': 'orange', 'keypoint': {'x': 501, 'y': 536}}],
    "Configuration_10_v2.png": [{'name': 'green', 'keypoint': {'x': 319, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 313, 'y': 493}}, {'name': 'blue', 'keypoint': {'x': 314, 'y': 475}}, {'name': 'blue', 'keypoint': {'x': 315, 'y': 445}}, {'name': 'green', 'keypoint': {'x': 342, 'y': 486}}, {'name': 'orange', 'keypoint': {'x': 339, 'y': 433}}, {'name': 'yellow', 'keypoint': {'x': 352, 'y': 521}}, {'name': 'blue', 'keypoint': {'x': 372, 'y': 480}}, {'name': 'yellow', 'keypoint': {'x': 376, 'y': 427}}, {'name': 'blue', 'keypoint': {'x': 413, 'y': 431}}, {'name': 'blue', 'keypoint': {'x': 405, 'y': 457}}, {'name': 'green', 'keypoint': {'x': 416, 'y': 496}}, {'name': 'yellow', 'keypoint': {'x': 408, 'y': 532}}, {'name': 'orange', 'keypoint': {'x': 461, 'y': 470}}, {'name': 'orange', 'keypoint': {'x': 501, 'y': 536}}],
    "Configuration_11_v1.png": [{'name': 'yellow', 'keypoint': {'x': 317, 'y': 548}}, {'name': 'yellow', 'keypoint': {'x': 289, 'y': 498}}, {'name': 'orange', 'keypoint': {'x': 330, 'y': 512}}, {'name': 'blue', 'keypoint': {'x': 325, 'y': 471}}, {'name': 'green', 'keypoint': {'x': 356, 'y': 453}}, {'name': 'green', 'keypoint': {'x': 387, 'y': 495}}, {'name': 'green', 'keypoint': {'x': 397, 'y': 547}}, {'name': 'green', 'keypoint': {'x': 420, 'y': 494}}, {'name': 'yellow', 'keypoint': {'x': 434, 'y': 548}}, {'name': 'blue', 'keypoint': {'x': 453, 'y': 508}}, {'name': 'yellow', 'keypoint': {'x': 459, 'y': 483}}, {'name': 'green', 'keypoint': {'x': 453, 'y': 446}}, {'name': 'yellow', 'keypoint': {'x': 499, 'y': 449}}, {'name': 'green', 'keypoint': {'x': 510, 'y': 510}}, {'name': 'yellow', 'keypoint': {'x': 354, 'y': 550}}],
    "Configuration_11_v2.png": [{'name': 'yellow', 'keypoint': {'x': 317, 'y': 548}}, {'name': 'yellow', 'keypoint': {'x': 289, 'y': 498}}, {'name': 'orange', 'keypoint': {'x': 330, 'y': 512}}, {'name': 'blue', 'keypoint': {'x': 325, 'y': 471}}, {'name': 'green', 'keypoint': {'x': 356, 'y': 453}}, {'name': 'green', 'keypoint': {'x': 387, 'y': 495}}, {'name': 'green', 'keypoint': {'x': 397, 'y': 547}}, {'name': 'green', 'keypoint': {'x': 420, 'y': 494}}, {'name': 'yellow', 'keypoint': {'x': 434, 'y': 548}}, {'name': 'blue', 'keypoint': {'x': 453, 'y': 508}}, {'name': 'yellow', 'keypoint': {'x': 459, 'y': 483}}, {'name': 'green', 'keypoint': {'x': 453, 'y': 446}}, {'name': 'yellow', 'keypoint': {'x': 499, 'y': 449}}, {'name': 'green', 'keypoint': {'x': 510, 'y': 510}}, {'name': 'yellow', 'keypoint': {'x': 354, 'y': 550}}],
    "Configuration_12_v1.png": [{'name': 'blue', 'keypoint': {'x': 334, 'y': 563}}, {'name': 'yellow', 'keypoint': {'x': 321, 'y': 526}}, {'name': 'orange', 'keypoint': {'x': 336, 'y': 503}}, {'name': 'blue', 'keypoint': {'x': 292, 'y': 470}}, {'name': 'yellow', 'keypoint': {'x': 318, 'y': 450}}, {'name': 'blue', 'keypoint': {'x': 375, 'y': 430}}, {'name': 'orange', 'keypoint': {'x': 376, 'y': 506}}, {'name': 'blue', 'keypoint': {'x': 360, 'y': 538}}, {'name': 'green', 'keypoint': {'x': 399, 'y': 475}}, {'name': 'green', 'keypoint': {'x': 407, 'y': 531}}, {'name': 'orange', 'keypoint': {'x': 440, 'y': 426}}, {'name': 'blue', 'keypoint': {'x': 463, 'y': 456}}, {'name': 'yellow', 'keypoint': {'x': 454, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 492, 'y': 525}}, {'name': 'orange', 'keypoint': {'x': 409, 'y': 442}}],
    "Configuration_12_v2.png": [{'name': 'blue', 'keypoint': {'x': 334, 'y': 563}}, {'name': 'yellow', 'keypoint': {'x': 321, 'y': 526}}, {'name': 'orange', 'keypoint': {'x': 336, 'y': 503}}, {'name': 'blue', 'keypoint': {'x': 292, 'y': 470}}, {'name': 'yellow', 'keypoint': {'x': 318, 'y': 450}}, {'name': 'blue', 'keypoint': {'x': 375, 'y': 430}}, {'name': 'orange', 'keypoint': {'x': 376, 'y': 506}}, {'name': 'blue', 'keypoint': {'x': 360, 'y': 538}}, {'name': 'green', 'keypoint': {'x': 399, 'y': 475}}, {'name': 'green', 'keypoint': {'x': 407, 'y': 531}}, {'name': 'orange', 'keypoint': {'x': 440, 'y': 426}}, {'name': 'blue', 'keypoint': {'x': 463, 'y': 456}}, {'name': 'yellow', 'keypoint': {'x': 454, 'y': 536}}, {'name': 'orange', 'keypoint': {'x': 492, 'y': 525}}, {'name': 'orange', 'keypoint': {'x': 409, 'y': 442}}],
    "Configuration_13_v1.png": [{'name': 'orange', 'keypoint': {'x': 312, 'y': 549}}, {'name': 'orange', 'keypoint': {'x': 333, 'y': 514}}, {'name': 'yellow', 'keypoint': {'x': 315, 'y': 494}}, {'name': 'blue', 'keypoint': {'x': 307, 'y': 439}}, {'name': 'orange', 'keypoint': {'x': 371, 'y': 544}}, {'name': 'yellow', 'keypoint': {'x': 389, 'y': 506}}, {'name': 'yellow', 'keypoint': {'x': 387, 'y': 466}}, {'name': 'yellow', 'keypoint': {'x': 418, 'y': 460}}, {'name': 'yellow', 'keypoint': {'x': 414, 'y': 498}}, {'name': 'green', 'keypoint': {'x': 441, 'y': 489}}, {'name': 'green', 'keypoint': {'x': 456, 'y': 513}}, {'name': 'yellow', 'keypoint': {'x': 468, 'y': 552}}, {'name': 'yellow', 'keypoint': {'x': 505, 'y': 506}}, {'name': 'blue', 'keypoint': {'x': 353, 'y': 466}}, {'name': 'blue', 'keypoint': {'x': 428, 'y': 421}}],
    "Configuration_13_v2.png": [{'name': 'orange', 'keypoint': {'x': 312, 'y': 549}}, {'name': 'orange', 'keypoint': {'x': 333, 'y': 514}}, {'name': 'yellow', 'keypoint': {'x': 315, 'y': 494}}, {'name': 'blue', 'keypoint': {'x': 307, 'y': 439}}, {'name': 'orange', 'keypoint': {'x': 371, 'y': 544}}, {'name': 'yellow', 'keypoint': {'x': 389, 'y': 506}}, {'name': 'yellow', 'keypoint': {'x': 387, 'y': 466}}, {'name': 'yellow', 'keypoint': {'x': 418, 'y': 460}}, {'name': 'yellow', 'keypoint': {'x': 414, 'y': 498}}, {'name': 'green', 'keypoint': {'x': 441, 'y': 489}}, {'name': 'green', 'keypoint': {'x': 456, 'y': 513}}, {'name': 'yellow', 'keypoint': {'x': 468, 'y': 552}}, {'name': 'yellow', 'keypoint': {'x': 505, 'y': 506}}, {'name': 'blue', 'keypoint': {'x': 353, 'y': 466}}, {'name': 'blue', 'keypoint': {'x': 428, 'y': 421}}],
    "Configuration_14_v1.png": [{'name': 'yellow', 'keypoint': {'x': 283, 'y': 489}}, {'name': 'green', 'keypoint': {'x': 307, 'y': 537}}, {'name': 'blue', 'keypoint': {'x': 306, 'y': 470}}, {'name': 'orange', 'keypoint': {'x': 345, 'y': 548}}, {'name': 'green', 'keypoint': {'x': 374, 'y': 527}}, {'name': 'blue', 'keypoint': {'x': 390, 'y': 486}}, {'name': 'blue', 'keypoint': {'x': 382, 'y': 455}}, {'name': 'green', 'keypoint': {'x': 391, 'y': 434}}, {'name': 'blue', 'keypoint': {'x': 438, 'y': 452}}, {'name': 'blue', 'keypoint': {'x': 439, 'y': 472}}, {'name': 'yellow', 'keypoint': {'x': 429, 'y': 510}}, {'name': 'orange', 'keypoint': {'x': 434, 'y': 542}}, {'name': 'blue', 'keypoint': {'x': 460, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 484, 'y': 538}}, {'name': 'green', 'keypoint': {'x': 488, 'y': 468}}],
    "Configuration_14_v2.png": [{'name': 'yellow', 'keypoint': {'x': 283, 'y': 489}}, {'name': 'green', 'keypoint': {'x': 307, 'y': 537}}, {'name': 'blue', 'keypoint': {'x': 306, 'y': 470}}, {'name': 'orange', 'keypoint': {'x': 345, 'y': 548}}, {'name': 'green', 'keypoint': {'x': 374, 'y': 527}}, {'name': 'blue', 'keypoint': {'x': 390, 'y': 486}}, {'name': 'blue', 'keypoint': {'x': 382, 'y': 455}}, {'name': 'green', 'keypoint': {'x': 391, 'y': 434}}, {'name': 'blue', 'keypoint': {'x': 438, 'y': 452}}, {'name': 'blue', 'keypoint': {'x': 439, 'y': 472}}, {'name': 'yellow', 'keypoint': {'x': 429, 'y': 510}}, {'name': 'orange', 'keypoint': {'x': 434, 'y': 542}}, {'name': 'blue', 'keypoint': {'x': 460, 'y': 497}}, {'name': 'orange', 'keypoint': {'x': 484, 'y': 538}}, {'name': 'green', 'keypoint': {'x': 488, 'y': 468}}],

}

# add the 'answer' column based on the 'Scenario' column
data['answer'] = data['Scenario'].apply(lambda x: correct_answers.get(x, None))
data['image_description'] = data['Scenario'].apply(lambda x: lab.get(x, None))
data = data[['Instruction', 'image_description', 'answer']]



train_df, test_df = train_test_split(data, test_size=0.1)  # Adjust the test_size

# # save to json:

# train_dict = train_df.to_dict(orient='records')
# test_dict = test_df.to_dict(orient='records')


# with open("train.jsonl", 'w') as f:
#   for line in train_dict:
#     f.write(json.dumps(line) + "\n")

# with open("test.jsonl", 'w') as f:
#   for line in test_dict:
#     f.write(json.dumps(line) + "\n")

train_rows = []  

for index, row in train_df.iterrows():
    text = f"[s][INST] {row['Instruction']} Image description: {row['image_description']}[/INST] {row['answer']}[/s]"
    train_rows.append({'text': text})  
train_data = pd.DataFrame(train_rows)

train_dict = train_data.to_dict(orient='records')

with open("train.jsonl", 'w') as f:
    for line in train_dict:
        f.write(json.dumps(line) + "\n")

test_rows = [] 

for index, row in test_df.iterrows():
    text = f"[s][INST] {row['Instruction']} Image description: {row['image_description']}[/INST] {row['answer']}[/s]"
    test_rows.append({'text': text})  
test_data = pd.DataFrame(test_rows)

test_dict = test_data.to_dict(orient='records')

with open("test.jsonl", 'w') as f:
    for line in test_dict:
        f.write(json.dumps(line) + "\n")
